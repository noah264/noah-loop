# Noah Loop æ™ºèƒ½ä½“å¹³å°åç«¯

<div align="center">

![Noah Loop](https://img.shields.io/badge/Noah%20Loop-v1.0.0-blue.svg)
![Go Version](https://img.shields.io/badge/Go-1.21+-00ADD8.svg)
![Architecture](https://img.shields.io/badge/Architecture-DDD%20Microservices-green.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)

åŸºäº DDDï¼ˆé¢†åŸŸé©±åŠ¨è®¾è®¡ï¼‰æ¶æ„çš„æ™ºèƒ½ä½“å¹³å°åç«¯ç³»ç»Ÿï¼Œæä¾›å®Œæ•´çš„æ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€å¤§æ¨¡å‹é›†æˆã€å·¥ä½œæµç¼–æ’å’ŒçŸ¥è¯†ç®¡ç†åŠŸèƒ½ã€‚

[å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹) â€¢ [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡) â€¢ [API æ–‡æ¡£](#api-æ–‡æ¡£) â€¢ [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—) â€¢ [å¼€å‘æŒ‡å—](#å¼€å‘æŒ‡å—)

</div>

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¤– æ™ºèƒ½ä½“ç®¡ç†
- **å¤šç±»å‹æ™ºèƒ½ä½“**ï¼šæ”¯æŒå¯¹è¯å‹ã€ä»»åŠ¡å‹ã€åæ€å‹ã€è§„åˆ’å‹ã€å¤šæ¨¡æ€æ™ºèƒ½ä½“
- **è®°å¿†ç³»ç»Ÿ**ï¼šçŸ­æœŸè®°å¿†ã€é•¿æœŸè®°å¿†ã€å­¦ä¹ è®°å¿†çš„å®Œæ•´ç®¡ç†
- **å·¥å…·é›†æˆ**ï¼šçµæ´»çš„å·¥å…·æ’ä»¶ç³»ç»Ÿï¼Œæ”¯æŒè‡ªå®šä¹‰å·¥å…·å¼€å‘
- **çŠ¶æ€ç®¡ç†**ï¼šå®Œæ•´çš„æ™ºèƒ½ä½“çŠ¶æ€è·Ÿè¸ªå’Œç”Ÿå‘½å‘¨æœŸç®¡ç†

### ğŸ§  å¤§è¯­è¨€æ¨¡å‹æœåŠ¡
- **å¤šæä¾›å•†æ”¯æŒ**ï¼šOpenAIã€Anthropicã€æœ¬åœ°æ¨¡å‹æ— ç¼é›†æˆ
- **ç»Ÿä¸€æ¥å£**ï¼šæ ‡å‡†åŒ–çš„æ¨¡å‹è°ƒç”¨æ¥å£ï¼Œæ”¯æŒåˆ‡æ¢å’Œè´Ÿè½½å‡è¡¡
- **æˆæœ¬æ§åˆ¶**ï¼šå®æ—¶æˆæœ¬ç›‘æ§ã€é¢„ç®—ç®¡ç†å’Œæ™ºèƒ½è·¯ç”±
- **ç¼“å­˜ä¼˜åŒ–**ï¼šæ™ºèƒ½ç¼“å­˜ç­–ç•¥æå‡å“åº”é€Ÿåº¦

### ğŸ’¬ ä¼šè¯ç®¡ç†
- **ä¸Šä¸‹æ–‡ç®¡ç†**ï¼šæ™ºèƒ½çš„å¯¹è¯ä¸Šä¸‹æ–‡ä¿æŒå’Œç›¸å…³æ€§è®¡ç®—
- **å¤šè½®å¯¹è¯**ï¼šæ”¯æŒé•¿æœŸä¼šè¯çŠ¶æ€ç®¡ç†
- **ä¸ªæ€§åŒ–**ï¼šåŸºäºç”¨æˆ·å†å²çš„ä¸ªæ€§åŒ–æ¨è

### âš¡ å·¥ä½œæµç¼–æ’
- **å¯è§†åŒ–è®¾è®¡**ï¼šæ‹–æ‹½å¼å·¥ä½œæµè®¾è®¡ç•Œé¢
- **å¤šè§¦å‘å™¨**ï¼šæ”¯æŒæ‰‹åŠ¨ã€å®šæ—¶ã€äº‹ä»¶ã€Webhook ç­‰è§¦å‘æ–¹å¼
- **å¹¶è¡Œå¤„ç†**ï¼šæ™ºèƒ½ä»»åŠ¡è°ƒåº¦å’Œå¹¶è¡Œæ‰§è¡Œ
- **ç›‘æ§åˆ†æ**ï¼šå®æ—¶æ‰§è¡Œç›‘æ§å’Œæ€§èƒ½åˆ†æ

### ğŸ“š çŸ¥è¯†ç®¡ç† (RAG)
- **å¤šæ ¼å¼æ–‡æ¡£**ï¼šæ”¯æŒæ–‡æœ¬ã€PDFã€Markdownã€HTMLã€Word ç­‰æ ¼å¼
- **æ™ºèƒ½åˆ†å—**ï¼šè‡ªåŠ¨è¯­ä¹‰åˆ†å—å’Œå‘é‡åŒ–
- **è¯­ä¹‰æœç´¢**ï¼šåŸºäºå‘é‡ç›¸ä¼¼åº¦çš„æ™ºèƒ½æœç´¢
- **çŸ¥è¯†åº“ç®¡ç†**ï¼šå¤šç§Ÿæˆ·çŸ¥è¯†åº“å’Œæƒé™æ§åˆ¶

### ğŸ“¬ é€šçŸ¥æœåŠ¡ (Notify)
- **å¤šæ¸ é“æ”¯æŒ**ï¼šé‚®ä»¶(SMTP)ã€çŸ­ä¿¡(é˜¿é‡Œäº‘)ã€æ¨é€(Bark)ã€Webhook(Serveré…±)
- **æ¨¡æ¿ç³»ç»Ÿ**ï¼šçµæ´»çš„é€šçŸ¥æ¨¡æ¿ç®¡ç†å’Œå˜é‡æ›¿æ¢
- **æ‰¹é‡å‘é€**ï¼šæ”¯æŒæ‰¹é‡é€šçŸ¥å’Œæ¥æ”¶è€…ç®¡ç†
- **é‡è¯•æœºåˆ¶**ï¼šæ™ºèƒ½é‡è¯•å’Œå¤±è´¥æ¢å¤

### ğŸ“¨ æ¶ˆæ¯é˜Ÿåˆ— (Kafka)
- **äº‹ä»¶é©±åŠ¨**ï¼šå®Œæ•´çš„äº‹ä»¶é©±åŠ¨æ¶æ„æ”¯æŒ
- **å¼‚æ­¥é€šä¿¡**ï¼šæœåŠ¡é—´é«˜æ€§èƒ½å¼‚æ­¥æ¶ˆæ¯ä¼ é€’
- **å¯é æŠ•é€’**ï¼šæ¶ˆæ¯æŒä¹…åŒ–å’Œé‡è¯•ä¿éšœ
- **åˆ†å¸ƒå¼è¿½è¸ª**ï¼šæ¶ˆæ¯é“¾è·¯å®Œæ•´å¯è§‚æµ‹æ€§

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ç³»ç»Ÿæ¶æ„å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Noah Loop æ™ºèƒ½ä½“å¹³å°                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                    â”‚
â”‚  â”‚  API Gateway â”‚ â† ç»Ÿä¸€å…¥å£ï¼Œè·¯ç”±åˆ†å‘ï¼Œè®¤è¯é‰´æƒï¼Œè´Ÿè½½å‡è¡¡              â”‚
â”‚  â”‚   (8080)     â”‚                                                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                    â”‚
â”‚        â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                      æ ¸å¿ƒå¾®æœåŠ¡æ¨¡å—                             â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚
â”‚  â”‚  â”‚Agent  â”‚ â”‚ LLM   â”‚ â”‚ MCP   â”‚ â”‚Orchestr.â”‚ â”‚ RAG   â”‚ â”‚Notify â”‚ â”‚ â”‚
â”‚  â”‚  â”‚:8081  â”‚ â”‚:8082  â”‚ â”‚:8083  â”‚ â”‚ :8084   â”‚ â”‚:8085  â”‚ â”‚:8086  â”‚ â”‚ â”‚
â”‚  â”‚  â”‚æ™ºèƒ½ä½“ â”‚ â”‚å¤§æ¨¡å‹ â”‚ â”‚ä¼šè¯   â”‚ â”‚å·¥ä½œæµ   â”‚ â”‚çŸ¥è¯†   â”‚ â”‚é€šçŸ¥   â”‚ â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        æ¶ˆæ¯å’Œäº‹ä»¶å±‚                            â”‚  â”‚
â”‚  â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚  â”‚
â”‚  â”‚           â”‚           Apache Kafka                  â”‚          â”‚  â”‚
â”‚  â”‚           â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚          â”‚  â”‚
â”‚  â”‚           â”‚  â”‚ Events  â”‚ â”‚ Notify  â”‚ â”‚    Logs     â”‚ â”‚          â”‚  â”‚
â”‚  â”‚           â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚          â”‚  â”‚
â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                    â”‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        å…±äº«åŸºç¡€è®¾æ–½å±‚                          â”‚  â”‚
â”‚  â”‚ PostgreSQL â”‚ Redis â”‚ etcd â”‚ Jaeger â”‚ Prometheus â”‚ MinIO â”‚ Milvus â”‚ â”‚
â”‚  â”‚    æ•°æ®åº“  â”‚ ç¼“å­˜  â”‚æœåŠ¡å‘ç°â”‚ é“¾è·¯è¿½è¸ªâ”‚   ç›‘æ§     â”‚å¯¹è±¡å­˜å‚¨â”‚å‘é‡åº“ â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæŠ€æœ¯
- **åç«¯è¯­è¨€**: Go 1.21+ 
- **Webæ¡†æ¶**: Gin (HTTP), gRPC (å¾®æœåŠ¡é€šä¿¡)
- **ORM**: GORM (æ•°æ®åº“æ“ä½œ)
- **æ¶æ„æ¨¡å¼**: DDD (é¢†åŸŸé©±åŠ¨è®¾è®¡), å¾®æœåŠ¡æ¶æ„
- **ä¾èµ–æ³¨å…¥**: Google Wire (ç¼–è¯‘æ—¶ä¾èµ–æ³¨å…¥)

#### æ•°æ®å­˜å‚¨
- **å…³ç³»æ•°æ®åº“**: PostgreSQL (ä¸»æ•°æ®åº“)
- **å‘é‡æ•°æ®åº“**: Milvus (å‘é‡æœç´¢å’Œç›¸ä¼¼åº¦è®¡ç®—)
- **ç¼“å­˜ç³»ç»Ÿ**: Redis (ä¼šè¯ã€ç¼“å­˜)
- **å¯¹è±¡å­˜å‚¨**: MinIO (æ–‡ä»¶å­˜å‚¨)

#### åŸºç¡€è®¾æ–½
- **æ¶ˆæ¯é˜Ÿåˆ—**: Apache Kafka (äº‹ä»¶é©±åŠ¨ã€å¼‚æ­¥é€šä¿¡)
- **æœåŠ¡å‘ç°**: etcd (æœåŠ¡æ³¨å†Œã€é…ç½®ç®¡ç†ã€å¯†é’¥å­˜å‚¨)
- **é“¾è·¯è¿½è¸ª**: Jaeger + OpenTelemetry (åˆ†å¸ƒå¼è¿½è¸ª)
- **ç›‘æ§å‘Šè­¦**: Prometheus + Grafana (æŒ‡æ ‡ç›‘æ§)
- **å®¹å™¨åŒ–**: Docker + Docker Compose

#### å¼€å‘å·¥å…·
- **ä»£ç ç”Ÿæˆ**: Wire (DI), Protocol Buffers (gRPC)
- **çƒ­é‡è½½**: Air (å¼€å‘ç¯å¢ƒ)
- **ä»£ç è´¨é‡**: golangci-lint, gofmt, goimports
- **æµ‹è¯•æ¡†æ¶**: Testify, GoConvey

### æ¨¡å—è¯¦ç»†ä»‹ç»

| æ¨¡å— | HTTP | gRPC | åŠŸèƒ½æè¿° | æŠ€æœ¯ç‰¹ç‚¹ |
|------|------|------|----------|----------|
| **api-gateway** | 8080 | 9090 | APIç½‘å…³ï¼Œç»Ÿä¸€å…¥å£ | è·¯ç”±åˆ†å‘ã€è®¤è¯é‰´æƒã€é™æµã€è´Ÿè½½å‡è¡¡ |
| **agent** | 8081 | 9091 | æ™ºèƒ½ä½“æ ¸å¿ƒæœåŠ¡ | å¤šç±»å‹æ™ºèƒ½ä½“ã€è®°å¿†ç®¡ç†ã€å·¥å…·é›†æˆ |
| **llm** | 8082 | 9092 | å¤§è¯­è¨€æ¨¡å‹æœåŠ¡ | å¤šæä¾›å•†ã€ç»Ÿä¸€æ¥å£ã€æ™ºèƒ½è·¯ç”± |
| **mcp** | 8083 | 9093 | ä¼šè¯ä¸Šä¸‹æ–‡ç®¡ç† | ä¸Šä¸‹æ–‡ç®¡ç†ã€ä¼šè¯çŠ¶æ€ã€ä¸ªæ€§åŒ– |
| **orchestrator** | 8084 | 9094 | å·¥ä½œæµç¼–æ’å¼•æ“ | æµç¨‹è®¾è®¡ã€ä»»åŠ¡è°ƒåº¦ã€å¹¶è¡Œæ‰§è¡Œ |
| **rag** | 8085 | 9095 | çŸ¥è¯†æ£€ç´¢æœåŠ¡ | æ–‡æ¡£ç®¡ç†ã€å‘é‡æœç´¢ã€è¯­ä¹‰æ£€ç´¢ |
| **notify** | 8086 | 9096 | å¤šæ¸ é“é€šçŸ¥æœåŠ¡ | é‚®ä»¶ã€çŸ­ä¿¡ã€æ¨é€ã€æ¨¡æ¿ç®¡ç† |
| **shared** | - | - | å…±äº«åŸºç¡€è®¾æ–½ | DDDåŸºç¡€ã€é…ç½®ç®¡ç†ã€Kafkaã€etcd |

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- **Go**: 1.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Docker**: 20.10 æˆ–æ›´é«˜ç‰ˆæœ¬
- **Docker Compose**: 2.0 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å†…å­˜**: å»ºè®® 4GB ä»¥ä¸Š
- **ç£ç›˜**: å»ºè®® 10GB ä»¥ä¸Šç©ºé—²ç©ºé—´

### ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd noah-loop

# å¯åŠ¨æ‰€æœ‰åŸºç¡€è®¾æ–½å’ŒæœåŠ¡
make up

# æ£€æŸ¥æœåŠ¡çŠ¶æ€
make status

# æŸ¥çœ‹æ—¥å¿—
make logs
```

### æ‰‹åŠ¨å¯åŠ¨

#### 1. å¯åŠ¨åŸºç¡€è®¾æ–½
```bash
cd backend

# å¯åŠ¨å®Œæ•´åŸºç¡€è®¾æ–½ï¼ˆæ¨èï¼‰
docker-compose -f deployments/docker-compose.infrastructure.yml up -d

# æˆ–è€…å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose -f deployments/docker-compose.yml up -d

# ç­‰å¾…æ‰€æœ‰æœåŠ¡å¯åŠ¨å®Œæˆ
docker-compose ps
```

#### 2. è®¾ç½®ç¯å¢ƒå˜é‡
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘ç¯å¢ƒå˜é‡
nano .env
```

å…³é”®ç¯å¢ƒå˜é‡ï¼š
```bash
# OpenAIé…ç½®
OPENAI_API_KEY=sk-your-openai-key

# Anthropicé…ç½®  
ANTHROPIC_API_KEY=sk-ant-your-anthropic-key

# æ•°æ®åº“é…ç½®
DATABASE_URL=postgres://postgres:postgres@localhost:5432/agent_db?sslmode=disable

# Redisé…ç½®
REDIS_URL=redis://localhost:6379/0

# etcdé…ç½®
ETCD_ENDPOINTS=localhost:2379

# Jaegeré…ç½®
JAEGER_ENDPOINT=http://localhost:14268/api/traces

# Kafkaé…ç½®
KAFKA_BROKERS=localhost:9092

# é€šçŸ¥æœåŠ¡é…ç½®ï¼ˆå¯é€‰ï¼‰
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=your-email@gmail.com
SMTP_PASSWORD=your-app-password

# é˜¿é‡Œäº‘çŸ­ä¿¡é…ç½®ï¼ˆå¯é€‰ï¼‰
ALIYUN_ACCESS_KEY=your-access-key
ALIYUN_SECRET_KEY=your-secret-key

# Barkæ¨é€é…ç½®ï¼ˆå¯é€‰ï¼‰
BARK_DEVICE_KEY=your-bark-device-key
```

#### 3. å®‰è£…ä¾èµ–å’Œæ„å»º
```bash
# åŒæ­¥å·¥ä½œç©ºé—´ä¾èµ–
go work sync

# å®‰è£…å¼€å‘å·¥å…·
make install-tools

# ç”Ÿæˆä»£ç ï¼ˆWireä¾èµ–æ³¨å…¥ã€Protobufç­‰ï¼‰
make generate

# æ„å»ºæ‰€æœ‰æ¨¡å—
make build
```

#### 4. å¯åŠ¨å„ä¸ªæœåŠ¡
```bash
# æ–¹å¼1ï¼šä½¿ç”¨Makefileï¼ˆæ¨èï¼‰
make run-all

# æ–¹å¼2ï¼šåˆ†åˆ«å¯åŠ¨å„ä¸ªæ¨¡å—
make run-gateway      # APIç½‘å…³ (8080)
make run-agent        # æ™ºèƒ½ä½“æœåŠ¡ (8081) 
make run-llm          # å¤§æ¨¡å‹æœåŠ¡ (8082)
make run-mcp          # ä¼šè¯ç®¡ç† (8083)
make run-orchestrator # å·¥ä½œæµç¼–æ’ (8084)
make run-rag          # çŸ¥è¯†æ£€ç´¢ (8085)
make run-notify       # é€šçŸ¥æœåŠ¡ (8086)

# æ–¹å¼3ï¼šç›´æ¥ä½¿ç”¨Goå‘½ä»¤
cd api-gateway && go run cmd/main.go &
cd modules/agent && go run cmd/main.go &
cd modules/llm && go run cmd/main.go &
cd modules/mcp && go run cmd/main.go &
cd modules/orchestrator && go run cmd/main.go &
cd modules/rag && go run cmd/main.go &
cd modules/notify && go run cmd/main.go &
```

### éªŒè¯å®‰è£…

```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡å¥åº·çŠ¶æ€
make health-check

# æˆ–è€…æ‰‹åŠ¨æ£€æŸ¥
curl http://localhost:8080/health  # API Gateway
curl http://localhost:8081/health  # Agent
curl http://localhost:8082/health  # LLM  
curl http://localhost:8083/health  # MCP
curl http://localhost:8084/health  # Orchestrator
curl http://localhost:8085/health  # RAG
curl http://localhost:8086/health  # Notify
```

é¢„æœŸå“åº”ï¼š
```json
{
  "status": "ok",
  "timestamp": "2024-01-20T10:00:00Z",
  "version": "1.0.0",
  "dependencies": {
    "database": "connected",
    "redis": "connected",
    "etcd": "connected"
  }
}
```

## ğŸ“– API æ–‡æ¡£

### RESTful API æ¦‚è§ˆ

#### æ™ºèƒ½ä½“ç®¡ç†
```bash
# åˆ›å»ºæ™ºèƒ½ä½“
POST /api/v1/agents
{
  "name": "æˆ‘çš„æ™ºèƒ½åŠ©æ‰‹",
  "type": "conversational",
  "description": "é€šç”¨å¯¹è¯åŠ©æ‰‹",
  "system_prompt": "ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„AIåŠ©æ‰‹",
  "capabilities": ["text_processing", "question_answering"]
}

# è·å–æ™ºèƒ½ä½“åˆ—è¡¨
GET /api/v1/agents?page=1&limit=20&type=conversational

# ä¸æ™ºèƒ½ä½“å¯¹è¯
POST /api/v1/agents/{id}/chat
{
  "message": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹äººå·¥æ™ºèƒ½çš„å‘å±•å†å²",
  "session_id": "session-uuid"
}
```

#### å¤§æ¨¡å‹æœåŠ¡
```bash
# èŠå¤©è¡¥å…¨
POST /api/v1/chat/completions
{
  "model": "gpt-3.5-turbo",
  "messages": [
    {"role": "system", "content": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„AIåŠ©æ‰‹"},
    {"role": "user", "content": "ä»€ä¹ˆæ˜¯æœºå™¨å­¦ä¹ ï¼Ÿ"}
  ],
  "temperature": 0.7,
  "max_tokens": 1000
}

# æ–‡æœ¬åµŒå…¥
POST /api/v1/embeddings
{
  "model": "text-embedding-ada-002",
  "input": ["äººå·¥æ™ºèƒ½", "æœºå™¨å­¦ä¹ ", "æ·±åº¦å­¦ä¹ "]
}
```

#### å·¥ä½œæµç®¡ç†
```bash
# åˆ›å»ºå·¥ä½œæµ
POST /api/v1/workflows
{
  "name": "æ•°æ®åˆ†ææµç¨‹",
  "description": "è‡ªåŠ¨åŒ–æ•°æ®åˆ†æå·¥ä½œæµ",
  "definition": {
    "steps": [
      {
        "id": "data_process",
        "name": "æ•°æ®å¤„ç†", 
        "type": "agent",
        "config": {"agent_id": "data-agent"}
      }
    ]
  }
}

# æ‰§è¡Œå·¥ä½œæµ
POST /api/v1/workflows/{id}/execute
{
  "input": {"data": "åˆ†ææ•°æ®"}
}
```

#### çŸ¥è¯†ç®¡ç†
```bash
# åˆ›å»ºçŸ¥è¯†åº“
POST /api/v1/knowledge-bases
{
  "name": "æŠ€æœ¯æ–‡æ¡£åº“",
  "description": "å­˜å‚¨æŠ€æœ¯ç›¸å…³æ–‡æ¡£",
  "settings": {
    "chunk_size": 1000,
    "embedding_model": "text-embedding-ada-002"
  }
}

# æ·»åŠ æ–‡æ¡£
POST /api/v1/documents
{
  "title": "APIè®¾è®¡æŒ‡å—",
  "content": "æœ¬æ–‡ä»‹ç»RESTful APIè®¾è®¡æœ€ä½³å®è·µ...",
  "knowledge_base_id": "kb-uuid"
}

# è¯­ä¹‰æœç´¢
POST /api/v1/search
{
  "query": "å¦‚ä½•è®¾è®¡RESTful API",
  "knowledge_base_id": "kb-uuid",
  "top_k": 5
}
```

#### é€šçŸ¥æœåŠ¡
```bash
# å‘é€é‚®ä»¶é€šçŸ¥
POST /api/v1/notifications
{
  "title": "ç³»ç»Ÿç»´æŠ¤é€šçŸ¥",
  "content": "ç³»ç»Ÿå°†åœ¨ä»Šæ™š22:00è¿›è¡Œç»´æŠ¤",
  "type": "system",
  "channel": "email",
  "recipients": [
    {
      "type": "email",
      "identifier": "admin@company.com"
    }
  ]
}

# åˆ›å»ºé€šçŸ¥æ¨¡æ¿
POST /api/v1/templates
{
  "name": "æ¬¢è¿é‚®ä»¶æ¨¡æ¿",
  "code": "welcome_email",
  "type": "html",
  "subject": "æ¬¢è¿åŠ å…¥{{company_name}}",
  "content": "äº²çˆ±çš„{{username}}ï¼Œæ¬¢è¿åŠ å…¥æˆ‘ä»¬ï¼",
  "variables": [
    {
      "name": "username",
      "required": true
    },
    {
      "name": "company_name",
      "default_value": "Noah Loop"
    }
  ]
}

# ä»æ¨¡æ¿å‘é€é€šçŸ¥
POST /api/v1/notifications/template
{
  "template_id": "welcome_email",
  "channel": "email",
  "variables": {
    "username": "å¼ ä¸‰",
    "company_name": "æˆ‘çš„å…¬å¸"
  },
  "recipients": [
    {
      "type": "email", 
      "identifier": "user@example.com"
    }
  ]
}
```

### API è®¤è¯

ç³»ç»Ÿæ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼š

```bash
# Bearer Tokenè®¤è¯
Authorization: Bearer <your-api-token>

# API Keyè®¤è¯
X-API-Key: <your-api-key>

# Basic Authè®¤è¯
Authorization: Basic <base64-encoded-credentials>
```

### è¯¦ç»†APIæ–‡æ¡£
- [æ™ºèƒ½ä½“ API](./modules/agent/README.md#api-æ–‡æ¡£)
- [å¤§æ¨¡å‹ API](./modules/llm/README.md#api-æ–‡æ¡£)
- [ä¼šè¯ç®¡ç† API](./modules/mcp/README.md#api-æ–‡æ¡£)
- [å·¥ä½œæµ API](./modules/orchestrator/README.md#api-æ–‡æ¡£)  
- [çŸ¥è¯†æ£€ç´¢ API](./modules/rag/README.md#api-æ–‡æ¡£)
- [é€šçŸ¥æœåŠ¡ API](./modules/notify/README.md#api-æ–‡æ¡£)

### é›†æˆæŒ‡å—
- [Kafkaæ¶ˆæ¯é˜Ÿåˆ—é›†æˆæŒ‡å—](./KAFKA_INTEGRATION_GUIDE.md)
- [åˆ†å¸ƒå¼è¿½è¸ªæŒ‡å—](./DISTRIBUTED_TRACING_GUIDE.md)
- [æœåŠ¡éƒ¨ç½²æŒ‡å—](./SERVICES_DEPLOYMENT_GUIDE.md)
- [åŸºç¡€è®¾æ–½é›†æˆæŒ‡å—](./INFRASTRUCTURE_INTEGRATION_GUIDE.md)

## ğŸ³ éƒ¨ç½²æŒ‡å—

### Docker Compose éƒ¨ç½²ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd noah-loop

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œè®¾ç½®ç”Ÿäº§ç¯å¢ƒé…ç½®

# å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

# æ£€æŸ¥éƒ¨ç½²çŠ¶æ€
docker-compose ps
```

### Kubernetes éƒ¨ç½²

```bash
# åˆ›å»ºå‘½åç©ºé—´
kubectl create namespace noah-loop

# åº”ç”¨é…ç½®
kubectl apply -f k8s/configmap.yaml
kubectl apply -f k8s/secrets.yaml

# éƒ¨ç½²åŸºç¡€è®¾æ–½
kubectl apply -f k8s/postgres.yaml
kubectl apply -f k8s/redis.yaml  
kubectl apply -f k8s/etcd.yaml

# éƒ¨ç½²åº”ç”¨æœåŠ¡
kubectl apply -f k8s/
```

### ç›‘æ§é¢æ¿è®¿é—®

éƒ¨ç½²å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ç›‘æ§é¢æ¿ï¼š

| æœåŠ¡ | åœ°å€ | è´¦å·å¯†ç  | åŠŸèƒ½è¯´æ˜ |
|------|------|----------|----------|
| **Grafana** | http://localhost:3000 | admin / admin | å¯è§†åŒ–ç›‘æ§é¢æ¿ |
| **Prometheus** | http://localhost:9090 | - | æŒ‡æ ‡æ”¶é›†å’ŒæŸ¥è¯¢ |
| **Jaeger** | http://localhost:16686 | - | åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª |
| **Kafka UI** | http://localhost:8090 | - | Kafkaç®¡ç†ç•Œé¢ |
| **MinIO** | http://localhost:9001 | minioadmin / minioadmin123 | å¯¹è±¡å­˜å‚¨ç®¡ç† |
| **etcd** | http://localhost:2379 | - | æœåŠ¡å‘ç°å’Œé…ç½® |

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„
```
noah-loop/
â”œâ”€â”€ backend/                    # åç«¯æœåŠ¡
â”‚   â”œâ”€â”€ api-gateway/           # APIç½‘å…³
â”‚   â”œâ”€â”€ modules/               # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ agent/            # æ™ºèƒ½ä½“æ¨¡å—  
â”‚   â”‚   â”œâ”€â”€ llm/              # å¤§æ¨¡å‹æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ mcp/              # ä¼šè¯ç®¡ç†æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ orchestrator/     # å·¥ä½œæµç¼–æ’æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ rag/              # çŸ¥è¯†æ£€ç´¢æ¨¡å—
â”‚   â”‚   â””â”€â”€ notify/           # é€šçŸ¥æœåŠ¡æ¨¡å—
â”‚   â”œâ”€â”€ shared/               # å…±äº«åŸºç¡€ä»£ç 
â”‚   â”œâ”€â”€ configs/              # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ deployments/          # éƒ¨ç½²é…ç½®
â”‚   â””â”€â”€ go.work              # Goå·¥ä½œç©ºé—´é…ç½®
â”œâ”€â”€ frontend/                  # å‰ç«¯åº”ç”¨ï¼ˆé¢„ç•™ï¼‰
â”œâ”€â”€ common/                    # é€šç”¨é…ç½®å’Œè„šæœ¬
â””â”€â”€ release/                  # å‘å¸ƒç›¸å…³æ–‡ä»¶
```

### DDD æ¶æ„å±‚æ¬¡

æ¯ä¸ªæ¨¡å—éƒ½éµå¾ªDDDæ¶æ„æ¨¡å¼ï¼š

```
module/
â”œâ”€â”€ cmd/                      # å¯åŠ¨å…¥å£
â”œâ”€â”€ internal/
â”‚   â”œâ”€â”€ domain/              # é¢†åŸŸå±‚
â”‚   â”‚   â”œâ”€â”€ entity/         # å®ä½“
â”‚   â”‚   â”œâ”€â”€ valueobject/    # å€¼å¯¹è±¡  
â”‚   â”‚   â”œâ”€â”€ service/        # é¢†åŸŸæœåŠ¡
â”‚   â”‚   â””â”€â”€ repository/     # ä»“å‚¨æ¥å£
â”‚   â”œâ”€â”€ application/         # åº”ç”¨å±‚
â”‚   â”‚   â””â”€â”€ service/        # åº”ç”¨æœåŠ¡
â”‚   â”œâ”€â”€ infrastructure/      # åŸºç¡€è®¾æ–½å±‚
â”‚   â”‚   â”œâ”€â”€ repository/     # ä»“å‚¨å®ç°
â”‚   â”‚   â”œâ”€â”€ config/         # é…ç½®
â”‚   â”‚   â””â”€â”€ external/       # å¤–éƒ¨æœåŠ¡
â”‚   â”œâ”€â”€ interface/          # æ¥å£å±‚
â”‚   â”‚   â”œâ”€â”€ http/          # HTTPæ¥å£
â”‚   â”‚   â””â”€â”€ grpc/          # gRPCæ¥å£
â”‚   â””â”€â”€ wire/              # ä¾èµ–æ³¨å…¥
â”œâ”€â”€ go.mod
â””â”€â”€ README.md
```

### å¼€å‘ç¯å¢ƒæ­å»º

#### 1. å®‰è£…å¼€å‘å·¥å…·
```bash
# å®‰è£…å¿…è¦å·¥å…·
make install-tools

# åŒ…æ‹¬ä»¥ä¸‹å·¥å…·ï¼š
# - Wire: ä¾èµ–æ³¨å…¥ä»£ç ç”Ÿæˆ
# - Air: çƒ­é‡è½½å·¥å…·
# - golangci-lint: ä»£ç æ£€æŸ¥
# - protoc: Protocol Buffersç¼–è¯‘å™¨
```

#### 2. é…ç½®IDE

**VS Code æ¨èæ’ä»¶:**
```json
{
  "recommendations": [
    "golang.go",
    "ms-vscode.vscode-json",
    "redhat.vscode-yaml",  
    "ms-kubernetes-tools.vscode-kubernetes-tools"
  ]
}
```

**GoLand é…ç½®:**
- å¯ç”¨ Go Modules
- é…ç½® Wire ä½œä¸ºä»£ç ç”Ÿæˆå™¨
- è®¾ç½® gofmt å’Œ goimports

#### 3. ä»£ç è§„èŒƒ

```bash
# æ ¼å¼åŒ–ä»£ç 
make fmt

# ä»£ç æ£€æŸ¥
make lint

# è¿è¡Œæµ‹è¯•
make test

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
make test-coverage
```

### ä»£ç ç”Ÿæˆ

```bash
# ç”Ÿæˆæ‰€æœ‰ä»£ç 
make generate

# å•ç‹¬ç”ŸæˆWireä»£ç 
make wire-gen

# ç”ŸæˆProtobufä»£ç ï¼ˆå¦‚éœ€è¦ï¼‰
make proto-gen

# ç”ŸæˆAPIæ–‡æ¡£
make docs
```

### çƒ­é‡è½½å¼€å‘

```bash
# å¯åŠ¨çƒ­é‡è½½å¼€å‘ç¯å¢ƒ
make dev

# æˆ–è€…å•ç‹¬å¯åŠ¨æŸä¸ªæ¨¡å—
cd modules/agent && make dev
```

### æµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
make test

# è¿è¡Œå•ä¸ªæ¨¡å—æµ‹è¯•
make test-agent
make test-llm
make test-rag
make test-notify

# é›†æˆæµ‹è¯•
make test-integration

# E2Eæµ‹è¯•
make test-e2e

# æ€§èƒ½æµ‹è¯•
make benchmark
```

## ğŸ“Š ç›‘æ§è¿ç»´

### ç³»ç»Ÿç›‘æ§

#### Prometheus æŒ‡æ ‡
æ‰€æœ‰æœåŠ¡éƒ½æš´éœ² Prometheus æŒ‡æ ‡ï¼š
```
# HTTPè¯·æ±‚æŒ‡æ ‡
http_requests_total
http_request_duration_seconds

# ä¸šåŠ¡æŒ‡æ ‡  
agent_requests_total
llm_requests_total
workflow_executions_total
notification_sent_total
kafka_messages_produced_total
kafka_messages_consumed_total

# ç³»ç»ŸæŒ‡æ ‡
go_memstats_alloc_bytes
go_memstats_gc_duration_seconds
```

#### Grafana ä»ªè¡¨æ¿
é¢„ç½®çš„ç›‘æ§é¢æ¿åŒ…æ‹¬ï¼š
- **ç³»ç»Ÿæ¦‚è§ˆ**: CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨æƒ…å†µ
- **åº”ç”¨æ€§èƒ½**: è¯·æ±‚é‡ã€å“åº”æ—¶é—´ã€é”™è¯¯ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: æ™ºèƒ½ä½“ä½¿ç”¨æƒ…å†µã€å·¥ä½œæµæ‰§è¡Œæƒ…å†µ
- **é€šçŸ¥ç›‘æ§**: å„æ¸ é“å‘é€æˆåŠŸç‡ã€å¤±è´¥åŸå› åˆ†æ
- **æ¶ˆæ¯é˜Ÿåˆ—**: Kafkaæ¶ˆæ¯ç”Ÿäº§æ¶ˆè´¹ç›‘æ§ã€å»¶è¿Ÿç»Ÿè®¡
- **æ•°æ®åº“ç›‘æ§**: è¿æ¥æ•°ã€æŸ¥è¯¢æ€§èƒ½
- **ç¼“å­˜ç›‘æ§**: Redisä½¿ç”¨æƒ…å†µ

#### é“¾è·¯è¿½è¸ª
Jaeger è¿½è¸ªåŠŸèƒ½ï¼š
- HTTPè¯·æ±‚é“¾è·¯è¿½è¸ª
- gRPCè°ƒç”¨é“¾è·¯è¿½è¸ª
- æ•°æ®åº“æŸ¥è¯¢è¿½è¸ª
- å¤–éƒ¨APIè°ƒç”¨è¿½è¸ª
- Kafkaæ¶ˆæ¯é“¾è·¯è¿½è¸ª
- é€šçŸ¥å‘é€é“¾è·¯è¿½è¸ª
- è‡ªå®šä¹‰spanæ ‡è®°

### æ—¥å¿—ç®¡ç†

#### æ—¥å¿—çº§åˆ«
```yaml
# é…ç½®ç¤ºä¾‹
log:
  level: "info"        # debug, info, warn, error
  format: "json"       # json, text
  output: "stdout"     # stdout, file
  file_path: "/var/log/noah-loop/"
```

#### ç»“æ„åŒ–æ—¥å¿—
```go
// ä½¿ç”¨ç¤ºä¾‹
log.WithFields(log.Fields{
  "user_id": userID,
  "agent_id": agentID,
  "action": "create_agent",
}).Info("Agent created successfully")
```

#### æ—¥å¿—èšåˆ
æ¨èä½¿ç”¨ ELK Stack æˆ– Lokiï¼š
```yaml
# docker-compose.logging.yml
services:
  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:7.17.0
  
  logstash:
    image: docker.elastic.co/logstash/logstash:7.17.0
    
  kibana:
    image: docker.elastic.co/kibana/kibana:7.17.0
```

### æ€§èƒ½ä¼˜åŒ–

#### æ•°æ®åº“ä¼˜åŒ–
```sql
-- å…³é”®ç´¢å¼•
CREATE INDEX idx_agents_owner_id ON agents(owner_id);
CREATE INDEX idx_agents_type_status ON agents(type, status);
CREATE INDEX idx_sessions_user_id ON sessions(user_id);

-- åˆ†åŒºè¡¨ï¼ˆå¤§è¡¨ä¼˜åŒ–ï¼‰
CREATE TABLE agent_logs (
  id UUID PRIMARY KEY,
  created_at TIMESTAMP,
  -- å…¶ä»–å­—æ®µ
) PARTITION BY RANGE (created_at);
```

#### ç¼“å­˜ç­–ç•¥
```yaml
# Redisç¼“å­˜é…ç½®
cache:
  redis:
    addr: "localhost:6379"
    password: ""
    db: 0
  
  policies:
    agents:
      ttl: 1h
      max_size: 10000
    
    sessions:
      ttl: 24h
      max_size: 50000
```

#### è¿æ¥æ± é…ç½®
```yaml
# æ•°æ®åº“è¿æ¥æ± 
database:
  max_open_conns: 100
  max_idle_conns: 10
  conn_max_lifetime: 1h
  conn_max_idle_time: 10m

# HTTPå®¢æˆ·ç«¯æ± 
http_client:
  max_idle_conns: 100
  max_idle_conns_per_host: 10
  idle_conn_timeout: 90s
```

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. æœåŠ¡å¯åŠ¨å¤±è´¥
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :8080

# æ£€æŸ¥æ—¥å¿—
docker-compose logs api-gateway

# æ£€æŸ¥é…ç½®
make check-config
```

#### 2. æ•°æ®åº“è¿æ¥é—®é¢˜
```bash
# æµ‹è¯•æ•°æ®åº“è¿æ¥
make db-test

# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
docker-compose exec postgres pg_isready -U postgres

# æŸ¥çœ‹è¿æ¥æ•°
docker-compose exec postgres psql -U postgres -c "SELECT count(*) FROM pg_stat_activity;"
```

#### 3. Redisè¿æ¥é—®é¢˜
```bash
# æµ‹è¯•Redisè¿æ¥
docker-compose exec redis redis-cli ping

# æ£€æŸ¥å†…å­˜ä½¿ç”¨
docker-compose exec redis redis-cli info memory
```

#### 4. æ¨¡å—é—´é€šä¿¡å¤±è´¥
```bash
# æ£€æŸ¥æœåŠ¡å‘ç°
curl http://localhost:2379/v2/keys/services

# æ£€æŸ¥ç½‘ç»œè¿é€šæ€§
docker-compose exec agent ping llm

# æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
sudo ufw status
```

#### 5. OpenAI API è°ƒç”¨å¤±è´¥
```bash
# æµ‹è¯•APIå¯†é’¥
curl -H "Authorization: Bearer $OPENAI_API_KEY" \
  https://api.openai.com/v1/models

# æ£€æŸ¥é…é¢
curl -H "Authorization: Bearer $OPENAI_API_KEY" \
  https://api.openai.com/v1/usage
```

### è°ƒè¯•å·¥å…·

```bash
# å…¨é¢å¥åº·æ£€æŸ¥
make health-check

# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
make status

# æŸ¥çœ‹ç‰¹å®šæœåŠ¡æ—¥å¿—
make logs service=agent

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker-compose exec agent bash

# æ•°æ®åº“è°ƒè¯•
make db-shell

# Redisè°ƒè¯•  
make redis-shell
```

### æ€§èƒ½åˆ†æ

```bash
# CPUæ€§èƒ½åˆ†æ
go tool pprof http://localhost:8081/debug/pprof/profile

# å†…å­˜åˆ†æ
go tool pprof http://localhost:8081/debug/pprof/heap

# goroutineåˆ†æ
go tool pprof http://localhost:8081/debug/pprof/goroutine
```

## ğŸ¤ å¼€å‘è´¡çŒ®

### è´¡çŒ®æµç¨‹

1. **Fork é¡¹ç›®**
   ```bash
   git clone https://github.com/your-username/noah-loop.git
   cd noah-loop
   ```

2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
   ```bash
   git checkout -b feature/your-feature-name
   ```

3. **å¼€å‘å’Œæµ‹è¯•**
   ```bash
   # å¼€å‘ä½ çš„åŠŸèƒ½
   make dev
   
   # è¿è¡Œæµ‹è¯•ç¡®ä¿åŠŸèƒ½æ­£å¸¸
   make test
   make lint
   ```

4. **æäº¤æ›´æ”¹**
   ```bash
   git add .
   git commit -m "feat: add your feature description"
   ```

5. **æ¨é€åˆ†æ”¯**
   ```bash
   git push origin feature/your-feature-name
   ```

6. **åˆ›å»º Pull Request**
   - åœ¨ GitHub ä¸Šåˆ›å»º PR
   - å¡«å†™è¯¦ç»†çš„PRæè¿°
   - ç¡®ä¿æ‰€æœ‰æ£€æŸ¥é€šè¿‡

### ä»£ç è§„èŒƒ

#### æäº¤æ¶ˆæ¯è§„èŒƒ
```
<type>(<scope>): <subject>

<body>

<footer>
```

ç±»å‹ (type):
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼åŒ–
- `refactor`: é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å˜åŠ¨

ç¤ºä¾‹ï¼š
```
feat(agent): add memory management for conversational agents

- Implement short-term and long-term memory
- Add memory search and retrieval functionality
- Include memory importance scoring

Closes #123
```

#### Go ä»£ç è§„èŒƒ
- éµå¾ª [Go Code Review Comments](https://github.com/golang/go/wiki/CodeReviewComments)
- ä½¿ç”¨ `gofmt` æ ¼å¼åŒ–ä»£ç 
- ä½¿ç”¨ `golangci-lint` è¿›è¡Œä»£ç æ£€æŸ¥
- å‡½æ•°å’Œæ–¹æ³•éœ€è¦æœ‰æ¸…æ™°çš„æ³¨é‡Š
- å…¬å…±APIéœ€è¦æœ‰å®Œæ•´çš„æ–‡æ¡£æ³¨é‡Š

### æµ‹è¯•è¦æ±‚

#### å•å…ƒæµ‹è¯•
```go
func TestAgentService_CreateAgent(t *testing.T) {
    // æµ‹è¯•ç”¨ä¾‹å®ç°
    assert := assert.New(t)
    
    agent, err := service.CreateAgent(ctx, request)
    
    assert.NoError(err)
    assert.NotNil(agent)
    assert.Equal("test-agent", agent.Name)
}
```

#### é›†æˆæµ‹è¯•
```go
func TestAgentIntegration(t *testing.T) {
    // é›†æˆæµ‹è¯•éœ€è¦ä½¿ç”¨æµ‹è¯•æ•°æ®åº“
    testDB := setupTestDB(t)
    defer teardownTestDB(t, testDB)
    
    // æµ‹è¯•å®ç°
}
```

#### æµ‹è¯•è¦†ç›–ç‡è¦æ±‚
- æ–°ä»£ç æµ‹è¯•è¦†ç›–ç‡éœ€è¦è¾¾åˆ° 80% ä»¥ä¸Š
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘éœ€è¦è¾¾åˆ° 90% ä»¥ä¸Š
- ä½¿ç”¨ `make test-coverage` æŸ¥çœ‹è¦†ç›–ç‡æŠ¥å‘Š

### æ–‡æ¡£è¦æ±‚

#### API æ–‡æ¡£
- æ‰€æœ‰å…¬å…±APIéƒ½éœ€è¦æœ‰è¯¦ç»†çš„æ–‡æ¡£
- ä½¿ç”¨ OpenAPI/Swagger è§„èŒƒ
- åŒ…å«è¯·æ±‚/å“åº”ç¤ºä¾‹

#### ä»£ç æ–‡æ¡£
- æ‰€æœ‰å…¬å…±å‡½æ•°/æ–¹æ³•éœ€è¦æœ‰æ³¨é‡Š
- å¤æ‚é€»è¾‘éœ€è¦å†…è”æ³¨é‡Šè¯´æ˜
- READMEæ–‡æ¡£éœ€è¦åŠæ—¶æ›´æ–°

### Issue å’Œ PR æ¨¡æ¿

#### Bug Report æ¨¡æ¿
```markdown
## Bug æè¿°
ç®€è¦æè¿°é‡åˆ°çš„é—®é¢˜

## å¤ç°æ­¥éª¤
1. æ‰§è¡Œæ“ä½œ1
2. æ‰§è¡Œæ“ä½œ2  
3. çœ‹åˆ°é”™è¯¯

## é¢„æœŸè¡Œä¸º
æè¿°ä½ é¢„æœŸçš„æ­£ç¡®è¡Œä¸º

## ç¯å¢ƒä¿¡æ¯
- OS: [e.g. Ubuntu 20.04]
- Goç‰ˆæœ¬: [e.g. 1.21.0]
- é¡¹ç›®ç‰ˆæœ¬: [e.g. v1.0.0]

## é¢å¤–ä¿¡æ¯
æ·»åŠ ä»»ä½•å…¶ä»–ç›¸å…³ä¿¡æ¯
```

#### Feature Request æ¨¡æ¿
```markdown
## åŠŸèƒ½æè¿°
è¯¦ç»†æè¿°ä½ å¸Œæœ›æ·»åŠ çš„åŠŸèƒ½

## ä½¿ç”¨åœºæ™¯
è§£é‡Šä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªåŠŸèƒ½

## è§£å†³æ–¹æ¡ˆ
å¦‚æœæœ‰å…·ä½“çš„å®ç°æƒ³æ³•ï¼Œè¯·æè¿°

## æ›¿ä»£æ–¹æ¡ˆ
æ˜¯å¦è€ƒè™‘è¿‡å…¶ä»–è§£å†³æ–¹æ¡ˆï¼Ÿ
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2024-01-20)

#### ğŸ‰ æ ¸å¿ƒåŠŸèƒ½æ¨¡å—
- âœ¨ **æ™ºèƒ½ä½“ç®¡ç†ç³»ç»Ÿ**: å®Œæ•´çš„å¤šç±»å‹æ™ºèƒ½ä½“ç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ¨ **å¤§è¯­è¨€æ¨¡å‹é›†æˆ**: å¤šæä¾›å•†ç»Ÿä¸€æ¥å£å’Œæ™ºèƒ½è·¯ç”±
- âœ¨ **å·¥ä½œæµç¼–æ’å¼•æ“**: å¯è§†åŒ–æµç¨‹è®¾è®¡å’Œå¹¶è¡Œæ‰§è¡Œ
- âœ¨ **çŸ¥è¯†æ£€ç´¢(RAG)ç³»ç»Ÿ**: å‘é‡æœç´¢å’Œè¯­ä¹‰æ£€ç´¢
- âœ¨ **ä¼šè¯ä¸Šä¸‹æ–‡ç®¡ç†**: æ™ºèƒ½å¯¹è¯çŠ¶æ€ç®¡ç†
- âœ¨ **å¤šæ¸ é“é€šçŸ¥æœåŠ¡**: é‚®ä»¶ã€çŸ­ä¿¡ã€æ¨é€ã€Webhookæ”¯æŒ

#### ğŸ—ï¸ åŸºç¡€æ¶æ„è®¾æ–½  
- ğŸ”§ **DDDå¾®æœåŠ¡æ¶æ„**: åŸºäºé¢†åŸŸé©±åŠ¨è®¾è®¡çš„æ¸…æ™°åˆ†å±‚
- ğŸ“¨ **Apache Kafka**: äº‹ä»¶é©±åŠ¨çš„æ¶ˆæ¯é˜Ÿåˆ—ç³»ç»Ÿ
- ğŸ” **etcdæœåŠ¡æ²»ç†**: æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†ã€å¯†é’¥å­˜å‚¨
- ğŸ” **OpenTelemetry+Jaeger**: å®Œæ•´çš„åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª
- ğŸ“Š **Prometheus+Grafana**: å…¨æ–¹ä½ç›‘æ§å’Œå¯è§†åŒ–
- ğŸ—„ï¸ **å¤šæ•°æ®å­˜å‚¨**: PostgreSQL + Redis + Milvus + MinIO

#### ğŸš€ å¼€å‘ä½“éªŒ
- âš¡ **Wireä¾èµ–æ³¨å…¥**: ç¼–è¯‘æ—¶ä¾èµ–æ³¨å…¥å’Œç±»å‹å®‰å…¨  
- ğŸ”¥ **çƒ­é‡è½½å¼€å‘**: Airæ”¯æŒçš„å¿«é€Ÿå¼€å‘è¿­ä»£
- ğŸ§ª **å®Œæ•´æµ‹è¯•æ¡†æ¶**: å•å…ƒã€é›†æˆã€E2Eæµ‹è¯•æ”¯æŒ
- ğŸ“– **è¯¦ç»†æ–‡æ¡£**: APIæ–‡æ¡£ã€éƒ¨ç½²æŒ‡å—ã€å¼€å‘æŒ‡å—
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²**: Docker Composeä¸€é”®éƒ¨ç½²

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](../LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®å¯¹æœ¬é¡¹ç›®çš„æ”¯æŒï¼š
- [Go](https://golang.org/) - é«˜æ€§èƒ½ç¼–ç¨‹è¯­è¨€
- [Gin](https://gin-gonic.com/) - HTTP Webæ¡†æ¶  
- [GORM](https://gorm.io/) - Go ORMåº“
- [Wire](https://github.com/google/wire) - ç¼–è¯‘æ—¶ä¾èµ–æ³¨å…¥å·¥å…·
- [Apache Kafka](https://kafka.apache.org/) - é«˜æ€§èƒ½åˆ†å¸ƒå¼æ¶ˆæ¯é˜Ÿåˆ—
- [etcd](https://etcd.io/) - åˆ†å¸ƒå¼é”®å€¼å­˜å‚¨
- [PostgreSQL](https://www.postgresql.org/) - å¼ºå¤§çš„å…³ç³»å‹æ•°æ®åº“
- [Redis](https://redis.io/) - é«˜æ€§èƒ½ç¼“å­˜æ•°æ®åº“
- [Milvus](https://milvus.io/) - å‘é‡æ•°æ®åº“
- [Jaeger](https://www.jaegertracing.io/) - åˆ†å¸ƒå¼é“¾è·¯è¿½è¸ª
- [OpenTelemetry](https://opentelemetry.io/) - å¯è§‚æµ‹æ€§æ¡†æ¶
- [Prometheus](https://prometheus.io/) - ç›‘æ§å’Œå‘Šè­¦ç³»ç»Ÿ
- [Grafana](https://grafana.com/) - å¯è§†åŒ–ç›‘æ§é¢æ¿

## ğŸ“ æ”¯æŒä¸åé¦ˆ

- ğŸ› [æŠ¥å‘ŠBug](https://github.com/noah-loop/issues/new?template=bug_report.md)
- ğŸ’¡ [åŠŸèƒ½å»ºè®®](https://github.com/noah-loop/issues/new?template=feature_request.md)  
- ğŸ’¬ [è®¨è®ºäº¤æµ](https://github.com/noah-loop/discussions)
- ğŸ“§ [é‚®ä»¶è”ç³»](mailto:support@noah-loop.com)
- ğŸŒŸ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª Starï¼

---

<div align="center">
  
**[â¬† å›åˆ°é¡¶éƒ¨](#noah-loop-æ™ºèƒ½ä½“å¹³å°åç«¯)**

Made with â¤ï¸ by Noah Loop Team

</div>

